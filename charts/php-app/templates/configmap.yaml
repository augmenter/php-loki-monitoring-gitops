apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "php-app.fullname" . }}-content
  labels:
    {{- include "php-app.labels" . | nindent 4 }}
data:
  index.php: |
    <?php
    function randomError() {
        $chance = rand(1, 5);
        if ($chance === 1) {
            $errorMessages = [
                "Error: File not found!",
                "Error: Invalid input detected!",
                "Error: Permission denied!",
                "Error: Database connection failed!",
                "Error: Out of memory!"
            ];
            
            $error = $errorMessages[array_rand($errorMessages)];
            file_put_contents('php://stderr', "Random error occurred: " . $error . PHP_EOL);
        } else {
            file_put_contents('php://stderr', "No error this time. Everything is running smoothly!" . PHP_EOL);
        }
    }
    
    echo "<h1>Hello World!</h1>";
    echo "<p>Current time: " . date('Y-m-d H:i:s') . "</p>";
    echo "<p>Server: " . $_SERVER['SERVER_NAME'] . "</p>";
    
    randomError();
    ?>